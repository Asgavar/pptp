# release process for pptp and pptp-extras package (ppp below)
# emacs: sh-mode

# make local repository up to date in case of other changes
git pull

# set shell variables for version
# (use -rc1 for release candidate 1, or blank for final release)
VERSION=1.8.0
RELEASE=

export VERSION RELEASE
echo "VERSION=${VERSION} RELEASE=${RELEASE}"

# check and fix versions
egrep "VERSION=|RELEASE=" Makefile
emacsclient Makefile

# update ChangeLog and NEWS with a release date
emacsclient NEWS
emacsclient ChangeLog
git commit -m "release $VERSION$RELEASE" NEWS ChangeLog Makefile

# tag
git tag ${VERSION}

# mkdist
make dist
mv pptp-${VERSION}${RELEASE}.tar.gz ../

# publish
cd ~/public_html/external/mine/pptp/
cp /home/james/pptp-client/pptp-${VERSION}${RELEASE}.tar.gz ./

gpg --detach-sign --armor --default-key ae2466c0 pptp-${VERSION}${RELEASE}.tar.gz 
mv pptp-${VERSION}${RELEASE}.tar.gz.asc pptp-${VERSION}${RELEASE}.tar.gz.signature

# update http://pptpclient.sourceforge.net/#download

# compose release candidate announcement
# To: pptpclient-devel@lists.sourceforge.net		(candidates)
# To: pptpclient-announce@lists.sourceforge.net		(final)
# From: James Cameron <james.cameron@hp.com>
# Subject: pptp-${VERSION}${RELEASE} released
# ...
# include NEWS
# point at release candidate pages
# http://quozl.netrek.org/pptp/
# http://quozl.linux.org.au/pptp/
# sign mail

mutt -s "pptp-1.8.0 released" pptpclient-devel@lists.sourceforge.net <<EOF
G'day,

PPTP Client 1.8.0 is released.

Changes since 1.7.2 are:

Can be downloaded from:
	http://sourceforge.net/project/showfiles.php?group_id=33063

4efce9f263e2c3f38d79d9df222476de  pptp-1.8.0.tar.gz
EOF

# todo, version matrix, linux distribution down left side, pptp & ppp top,
# then a link to instructions
