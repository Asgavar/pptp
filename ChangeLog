Thu Aug 15 09:30:00 2002  Chris Wilson  <chris@netservers.co.uk>

	* pqueue.h: increased window size following James' tests
	* pptp_gre.c: check for errors while dequeueing packets

Wed Aug 14 20:02:39 2002  James Cameron  <quozl@us.netrek.org>

	* pptp.c, pptp_gre.c, pqueue.c: packet re-ordering bugfixes
	following distributed testing:

	- Moved daemon() call to run on GRE gateway process only, and not
	if running as pppd pty
	- Make select() timeout after 1 second if there is data in the
	queue, to prevent the queue from having to wait forever
	- Added log messages for accepting individual packets (noisy!)
	and for timeouts on missing packets
	- Fixed a bug with the packet queue (append to tail was broken)
	- Removed unused code from pqueue.c
	
	From: chris@netservers.co.uk

Wed Aug 14 11:14:05 2002  James Cameron  <quozl@us.netrek.org>

	* pqueue.c, pqueue.h, pptp_gre.c: major changes to support packet
	re-ordering.

	Queueing

	Packets are added to the queue by decaps_gre if their sequence
	number is higher than expected, but within the window. The default
	window is defined as 30 packets.

	Packets which are below the window (older than the most recent
	packet read) or above the window (too far ahead) are discarded, to
	protect against denial-of-service attacks.

	Dequeueing

	The new function dequeue_gre retrieves packets from the head of
	the queue which are:

	1. Next in sequence (unwrapped or wrapped)

	2. Older than five seconds (assuming that the intermediate packets
	have been lost by the network).

	The function will continue to read packets from the head of the
	queue until it finds one which doesn't match these criteria, and
	then stop.

	Limitations
	
	There are some limitations with this patch:

	- The receive window is hardcoded at 30 packets. I couldn't see
	where to get the negotiated and/or current window size from.

	- The timeout is hardcoded at 5 seconds. A packet which was
	received and queued within the window, but which should have been
	preceded by other packets which never appeared, will be accepted
	anyway after this time (increasing the sequence number to its
	own).

	- There may be memory leaks or other bugs in the reordering code.
	
	* pqueue.c, pqueue.h, Makefile (PPTP_OBJS, PPTP_DEPS): add two new
	files to the pptp executable. pqueue.c implements the packet queue
	used by the reordering code, and pqueue.h describes its public
	interface. The queue is implemented as a linked list. This is
	required for reordering.
	
	* pptp.c: Add a new command-line option, --debug.  Prevents pptp
	from going into the background.

	Change to call the daemon(3) function to change the current
	directory and close the standard file descriptors. This prevents a
	shell from hanging open if pptp is started remotely.

	* Makefile (CFLAGS): reduce the optimisation level (gcc's -O flag)
	to zero (none), to make debugging easier.

	* pptp.c (get_ip_address): avoid reporting h_errno value.

	From: chris@netservers.co.uk

Thu Jul 18 12:26:25 2002  James Cameron  <quozl@us.netrek.org>

	* pptp_gre.h, pptp_gre.c, pptp.c: bind the GRE socket early, by
	calling the a function pptp_gre_bind.  Also changed prototype of
	pptp_gre_copy.  Fixes ICMP Unreachable bug:
	<1026868263.2855.67.camel@jander> 16th July 2002.
	From: chris@netservers.co.uk

Thu May 30 18:28:02 2002  James Cameron  <quozl@us.netrek.org>

	* pptp_ctrl.c (pptp_call_open): do translation to network byte
	order after limit checking of phone number.
	From: staelin@hpl.hp.com
	
2002-05-13 08:14:40  Muli Ben-Yehuda  <mulix@actcom.co.il>

	* TODO: remove 'remove setjmp/longjmp' TODO item. 
	* pptp.c: change comment re volatile qualifiers. 
	* pptp_callmgr.c: remove unused function 'conn_callback' and
	change comment re volatile qualifiers. 

Thu Apr  4 09:34:10 2002  James Cameron  <quozl@us.netrek.org>

	* pptp_ctrl.c: correct spelling error.
	From: Mary.Deck@COMPAQ.com

2002-03-30 13:13:52  mulix  <mulix@actcom.co.il>

	* USING: change URL for bezeq adsl howto.  
	* pptp.c: (get_ip_address): if the user runs 'pptp --quirks ...'
	instead of 'pptp hostname', we'll get here and then give a verbose
	error message. 

Mon Mar 11 10:21:00 2002  mulix  <mulix@actcom.co.il>

	* Makefile (all): make config.h before making $(PPTP_BIN). 
	* Makefile (config.h): truncate the file if it exists before
	inputing to it - '>' instead of '>>'

Mon Mar 11 12:48:16 2002  James Cameron  <quozl@us.netrek.org>

	* DEVELOPERS: add mailing lists.
	* Makefile (CFLAGS): remove PPPD_BINARY and PPTP_LINUX_VERSION in
	favour of a config.h file.
	* Makefile (config.h): create config.h from Makefile variables
	* Makefile (PPTP_DEPS): add config.h
	* pptp.c: include config.h
	* version.c: include config.h
	* util.c (PROGRAM_NAME): no longer used by two programs, change
	PROGRAM_NAME to default to pptp.
	* Makefile (CFLAGS): remove -DPROGRAM_NAME

Fri Mar  8 11:56:00 2002  mulix  <mulix@actcom.co.il>

	* TODO: remove notes about compiler warnings, as all compiler
	warnings are now gone.
	* pptp.c (main): add volatile qualifier to some variables to
	silence gcc warnings 'variable might be clobbered by longjmp or
	vfork'. add note explaining why volatile and that it should be
	removed when the longjmp is removed.
	* pptp_callmgr.c (main): likewise. 
	* inststr.c (inststr): break up "ptr += strlen(++ptr)" which is
	undefined behaviour into two expressions. 
	* pptp.c (main): initialize callmgr_sock to -1 since it might be
	used uninitialized otherwise. 
	* pptp_ctrl.c (pptp_dispatch_ctrl_packet): #ifdef 0 two unused
	variables referring to the current packet, which should not be
	simply erased, as we might want to use them in the future.
	* util.c: add missing #include. 
	
Fri Mar  8 21:11:17 2002  James Cameron  <quozl@us.netrek.org>

	* DEVELOPERS: new file.

Fri Mar  8 10:12:28 2002  James Cameron  <quozl@us.netrek.org>

	* NEWS: convert to newest first format to comply with GNU Coding
	Standards, The NEWS File.

Fri Mar  8 09:01:22 2002  James Cameron  <quozl@us.netrek.org>

	* pptp_ctrl.c (pptp_make_packet): Cisco PIX is generating a
	non-complaint header with the reserved0 field not zero, causing
	the connection to stop after 60 seconds.
	From: Rein Klazes <rklazes@xs4all.nl>

Fri Mar  8 08:56:30 2002  James Cameron  <quozl@us.netrek.org>

	* TODO: add compiler warnings note.
	* NEWS: propogate summary of ChangeLog.
	* AUTHORS: add names from mailing list contributions.
	From: Rein Klazes <rklazes@xs4all.nl>
	* Makefile: remove pptp_callmgr binary
	* debian/copyright: adjust pointer to current release.
	* debian/rules, Makefile: remove pptp_callmgr binary now that pptp
	forks and calls it without exec.

Sat Mar  2 04:04:37 2002  James Cameron  <quozl@us.netrek.org>

	* README: adopt new mailing lists and point to project web site.
	* USING: include psuedo-tty activation instructions.
	* Makefile: increment version, avoid clobbering editor backup
	files on clean.

Fri Mar  1 12:13:03 2002  James Cameron  <quozl@us.netrek.org>

	* pptp_gre.c: move #include <sys/types.h> higher up
	* pptp_gre.c, pptp_ctrl.c: change unsigned to unsigned int
	* pptp.c: what we need from pty.h is in libutil.h for FreeBSD and
	util.h for NetBSD (ideally this should be in autoconf)
	* pptp.c: synchronisation changes
	* orckit_quirks.c: #include <sys/types.h>
	From: rhialto@azenomei.knuffel.net

Fri Nov 23 14:42:07 2001  James Cameron  <quozl@us.netrek.org>

	* USING: reformat, add version header.

Tue Nov 20 11:01:10 2001  mulix  <mulix@actcom.co.il>

	* AUTHORS: add mulix.
	* USING: add paragraph on quirks support.
	* orckit_quirks.c: remove debugging call, rename functions and
	variables consistently.
	* pptp.c: (usage) remove debugging print.
	* pptp_ctrl.c: when calling quirks hooks, check their return
	values and warn if an error occurs.
	* pptp_quirks.c: orckit_atur3_start_ctrl_conn was renamed
	orckit_atur3_start_ctrl_conn_hook.
	From: mulix@actcom.co.il

Tue Nov 20 17:01:10 2001  James Cameron  <quozl@us.netrek.org>

	* orckit_quirks.c, orckit_quirks.h: add quirks handling for orckit
	adsl modems.
	* pptp_quirks.c, pptp_quirks.h: add generic quirks handling.
	* Makefile (PPTP_DEPS, PPTP_OBJS, CALLMGR_OBJS, CALLMGR_DEPS): add
	quirks sources and objects.
	* pptp_ctrl.c: add pptp_set_link, add code to adjust packets
	depending on quirks.
	* pptp.c (usage, long_options, main): add --quirks command line
	option.
	From: mulix@actcom.co.il

Tue Nov 20 16:45:35 2001  James Cameron  <quozl@us.netrek.org>

	* pptp_gre.c: enhance error message for bad FCS.

